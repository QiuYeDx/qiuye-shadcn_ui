{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "dual-state-toggle",
  "title": "DualStateToggle",
  "type": "registry:component",
  "author": "QiuYeDx <me@qiuyedx.com>",
  "dependencies": [
    "motion",
    "lucide-react"
  ],
  "registryDependencies": [
    "button"
  ],
  "files": [
    {
      "type": "registry:component",
      "path": "components/qiuye-ui/dual-state-toggle.tsx",
      "content": "\"use client\";\n\nimport * as React from \"react\";\nimport { AnimatePresence, motion } from \"motion/react\";\n\nimport { Button } from \"@/components/ui/button\";\nimport { cn } from \"@/lib/utils\";\n\n/* -------------------------------------------------------------------------- */\n/*                                   Types                                    */\n/* -------------------------------------------------------------------------- */\n\ntype ButtonProps = React.ComponentProps<typeof Button>;\n\n/** 内置过渡效果预设名 */\ntype ToggleEffectPreset = \"fade\" | \"rotate\" | \"slide-up\" | \"slide-down\" | \"scale\";\n\ntype MotionValues = Record<string, string | number>;\n\n/** 自定义过渡效果配置 */\ninterface ToggleEffectConfig {\n  /** 进入起始 / 退出结束 的动画属性 */\n  initial: MotionValues;\n  /** 静止态属性（通常是各属性的\"归零\"值） */\n  animate: MotionValues;\n  /** 退出结束态属性 */\n  exit: MotionValues;\n}\n\n/** 过渡效果：预设名 | 自定义配置 */\ntype ToggleEffect = ToggleEffectPreset | ToggleEffectConfig;\n\n/* -------------------------------------------------------------------------- */\n/*                              Effect Presets                                */\n/* -------------------------------------------------------------------------- */\n\nconst EFFECT_PRESETS: Record<ToggleEffectPreset, ToggleEffectConfig> = {\n  /** 仅 opacity + blur（基础效果） */\n  fade: {\n    initial: {},\n    animate: {},\n    exit: {},\n  },\n  /** opacity + blur + 旋转 */\n  rotate: {\n    initial: { rotate: -90 },\n    animate: { rotate: 0 },\n    exit: { rotate: 90 },\n  },\n  /** opacity + blur + 向上滑入/滑出 */\n  \"slide-up\": {\n    initial: { y: 6 },\n    animate: { y: 0 },\n    exit: { y: -6 },\n  },\n  /** opacity + blur + 向下滑入/滑出 */\n  \"slide-down\": {\n    initial: { y: -6 },\n    animate: { y: 0 },\n    exit: { y: 6 },\n  },\n  /** opacity + blur + 缩放（0.75 → 1 → 0.75） */\n  scale: {\n    initial: { scale: 0.75 },\n    animate: { scale: 1 },\n    exit: { scale: 0.75 },\n  },\n};\n\n/* -------------------------------------------------------------------------- */\n/*                                   Props                                    */\n/* -------------------------------------------------------------------------- */\n\nexport interface DualStateToggleProps\n  extends Omit<ButtonProps, \"onClick\" | \"onToggle\" | \"children\"> {\n  /** 是否处于激活状态 */\n  active: boolean;\n  /** 状态切换回调 */\n  onToggle: (active: boolean) => void;\n  /** 激活状态下显示的图标 */\n  activeIcon: React.ReactNode;\n  /** 非激活状态下显示的图标 */\n  inactiveIcon: React.ReactNode;\n  /** 激活状态的无障碍标签 */\n  activeLabel?: string;\n  /** 非激活状态的无障碍标签 */\n  inactiveLabel?: string;\n  /**\n   * 图标切换时的模糊程度\n   * @default \"2px\"\n   */\n  blurAmount?: string;\n  /**\n   * 按钮形状快捷设置\n   * - `\"square\"` — 默认圆角矩形（shadcn/ui Button 原始圆角）\n   * - `\"circle\"` — 纯圆形按钮（`rounded-full`）\n   *\n   * 也可以忽略此属性，通过 `className` 自定义圆角\n   * @default \"square\"\n   */\n  shape?: \"square\" | \"circle\";\n  /**\n   * 图标切换过渡效果\n   *\n   * **预设值：**\n   * - `\"fade\"` — 仅 opacity + blur（默认）\n   * - `\"rotate\"` — 附加旋转（-90° → 0° → 90°）\n   * - `\"slide-up\"` — 附加向上滑动\n   * - `\"slide-down\"` — 附加向下滑动\n   * - `\"scale\"` — 附加缩放（0.75 → 1 → 0.75）\n   *\n   * **自定义配置：** 传入 `{ initial, animate, exit }` 对象，\n   * 会与基础的 opacity + blur 动画合并。\n   *\n   * @default \"fade\"\n   *\n   * @example\n   * ```tsx\n   * // 使用预设\n   * <DualStateToggle effect=\"rotate\" ... />\n   *\n   * // 自定义效果\n   * <DualStateToggle\n   *   effect={{\n   *     initial: { rotate: -180, scale: 0.6 },\n   *     animate: { rotate: 0, scale: 1 },\n   *     exit:    { rotate: 180, scale: 0.6 },\n   *   }}\n   *   ...\n   * />\n   * ```\n   */\n  effect?: ToggleEffect;\n  /**\n   * 图标切换动画时长（秒）\n   * @default 0.25\n   */\n  transitionDuration?: number;\n}\n\n/* -------------------------------------------------------------------------- */\n/*                                 Component                                  */\n/* -------------------------------------------------------------------------- */\n\n/**\n * DualStateToggle — 标准双状态切换按钮\n *\n * 基于 shadcn/ui Button，内置点击缩放 + 图标切换动画。\n * 默认 `variant=\"default\"` + `size=\"icon\"`，可通过 props 覆盖。\n *\n * ## 按钮尺寸 & 图标尺寸\n *\n * 按钮尺寸遵循 shadcn/ui Button 规范：\n * - `size=\"icon\"`（默认）→ 36px 方形，icon 自动 size-4（16px）\n * - `size=\"icon-xs\"` → 24px 方形，icon 自动 size-3（12px）\n * - `size=\"icon-sm\"` → 32px 方形，icon 自动 size-4（16px）\n * - `size=\"icon-lg\"` → 40px 方形，icon 自动 size-4（16px）\n *\n * Icon 尺寸由 Button 通过 `[&_svg:not([class*='size-'])]:size-4` 自动控制，\n * **不需要**在 icon 上手动添加 `h-* w-*`。若需自定义尺寸，使用 `size-*`\n * 类名（如 `size-5`），Button 会自动跳过自动尺寸控制。\n *\n * @example\n * ```tsx\n * // 基本用法 — 默认 fade 效果（icon 自动 16px）\n * <DualStateToggle\n *   active={isOpen}\n *   onToggle={setIsOpen}\n *   activeIcon={<XIcon />}\n *   inactiveIcon={<MenuIcon />}\n *   activeLabel=\"关闭\"\n *   inactiveLabel=\"打开\"\n * />\n *\n * // 旋转效果 + 圆形按钮\n * <DualStateToggle\n *   active={isOpen}\n *   onToggle={setIsOpen}\n *   activeIcon={<XIcon />}\n *   inactiveIcon={<MenuIcon />}\n *   effect=\"rotate\"\n *   shape=\"circle\"\n * />\n *\n * // 自定义 icon 尺寸 — 使用 size-* 前缀\n * <DualStateToggle\n *   active={isOpen}\n *   onToggle={setIsOpen}\n *   activeIcon={<XIcon className=\"size-5\" />}\n *   inactiveIcon={<MenuIcon className=\"size-5\" />}\n *   size=\"icon-lg\"\n * />\n *\n * // 自定义效果 + 透传 Button props\n * <DualStateToggle\n *   active={isMuted}\n *   onToggle={setIsMuted}\n *   activeIcon={<VolumeOffIcon />}\n *   inactiveIcon={<Volume2Icon />}\n *   variant=\"outline\"\n *   blurAmount=\"4px\"\n *   effect={{\n *     initial: { rotate: -180, scale: 0.6 },\n *     animate: { rotate: 0, scale: 1 },\n *     exit:    { rotate: 180, scale: 0.6 },\n *   }}\n * />\n * ```\n */\nexport function DualStateToggle({\n  active,\n  onToggle,\n  activeIcon,\n  inactiveIcon,\n  activeLabel,\n  inactiveLabel,\n  blurAmount = \"2px\",\n  shape = \"square\",\n  effect = \"fade\",\n  transitionDuration = 0.25,\n  // shadcn/ui Button props — 提供最常用的默认值，外部可覆盖\n  variant = \"default\",\n  size = \"icon\",\n  className,\n  ...buttonProps\n}: DualStateToggleProps) {\n  // 解析过渡效果（预设 or 自定义）\n  const resolvedEffect: ToggleEffectConfig =\n    typeof effect === \"string\" ? EFFECT_PRESETS[effect] : effect;\n\n  // 基础动画：opacity + blur（始终存在）\n  const blurFilter = `blur(${blurAmount})`;\n  const baseInitial = { opacity: 0, filter: blurFilter };\n  const baseAnimate = { opacity: 1, filter: \"blur(0px)\" };\n  const baseExit = { opacity: 0, filter: blurFilter };\n\n  // 合并：基础 + 过渡效果\n  const motionInitial = { ...baseInitial, ...resolvedEffect.initial };\n  const motionAnimate = { ...baseAnimate, ...resolvedEffect.animate };\n  const motionExit = { ...baseExit, ...resolvedEffect.exit };\n\n  return (\n    <Button\n      variant={variant}\n      size={size}\n      className={cn(\n        \"transition-transform duration-150 active:scale-[0.97] cursor-pointer\",\n        shape === \"circle\" && \"rounded-full\",\n        className\n      )}\n      onClick={() => onToggle(!active)}\n      {...buttonProps}\n    >\n      <AnimatePresence mode=\"popLayout\" initial={false}>\n        {active ? (\n          <motion.span\n            key=\"dual-toggle-active\"\n            initial={motionInitial}\n            animate={motionAnimate}\n            exit={motionExit}\n            transition={{ duration: transitionDuration }}\n            className=\"flex items-center justify-center\"\n          >\n            {activeIcon}\n          </motion.span>\n        ) : (\n          <motion.span\n            key=\"dual-toggle-inactive\"\n            initial={motionInitial}\n            animate={motionAnimate}\n            exit={motionExit}\n            transition={{ duration: transitionDuration }}\n            className=\"flex items-center justify-center\"\n          >\n            {inactiveIcon}\n          </motion.span>\n        )}\n      </AnimatePresence>\n\n      {(activeLabel || inactiveLabel) && (\n        <span className=\"sr-only\">\n          {active ? activeLabel : inactiveLabel}\n        </span>\n      )}\n    </Button>\n  );\n}\n"
    }
  ]
}
